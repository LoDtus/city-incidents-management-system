// Insert into chưa đúng với thiết kế của ứng dụng
// Kiểm tra khả năng update trong application.properties
create database if not exists `cims`;

use `cims`;
drop table if exists `users`;
drop table if exists `roles`;
drop table if exists `user_role`;

create table `users` (
	`id` int auto_increment primary key,
    `full_name` varchar(100) character set utf8mb4 not null,
    `username` varchar(100) character set latin1 not null,
    `password` varchar(255) character set latin1 not null
);

create table `roles` (
	`id` int auto_increment primary key,
    `role` varchar(20) character set latin1 not null
);

// Nếu user nào đó bị xóa / cập nhật thì thông tin về user đó trong user_role cũng sẽ xóa / cập nhật
create table `user_role` (
	`user_id` int references `users`(`id`) on delete cascade,
	`role_id` int references `roles`(`id`) on delete cascade,
	primary key (`user_id`, `role_id`),
    foreign key (`user_id`) references `users`(`id`) on update cascade on delete cascade,
    foreign key (`role_id`) references `roles`(`id`) on update cascade on delete cascade
);

insert into `users`(`full_name`, `username`, `password`) values
('Nguyễn Trung Long', 'nguyentrunglong', '123'),
('Trần Thanh Hà', 'tranthanhha', '123'),
('Nguyễn Thị Phương Ly', 'phuongly', '123');

insert into `roles`(`role`) values
('ROLE_ADMIN'),
('ROLE_MANAGER'),
('ROLE_STAFF'),
('ROLE_USER'),
('ROLE_GUEST');

insert into `user_role`(`user_id`, `role_id`) values
(1, 1),
(2, 2),
(3, 3);